<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>AquaSky</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
</head>
<body>
  <a-scene>
    <a-assets>
      <img id="ocean360" src="assets/ocean360.jpg" crossorigin="anonymous" />
      <audio id="narr" src="assets/narra.mp3"></audio>
    </a-assets>

    <a-sky src="#ocean360" rotation="0 -90 0"></a-sky>

    <a-entity camera look-controls position="0 1.6 0">
      <a-entity cursor="fuse: true; fuseTimeout: 800" position="0 0 -1"
                geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
                material="shader: flat; opacity: 0.9">
      </a-entity>
    </a-entity>

    <a-entity id="hotspot1" geometry="primitive: sphere; radius: 0.25"
              material="color: #ff4444; opacity: 0.8"
              position="0 1.4 -3" class="interactable">
    </a-entity>

    <a-entity id="infoBox" visible="false" position="0 1.5 -1.5">
      <a-plane width="1.6" height="0.7" color="#000" opacity="0.6"></a-plane>
      <a-text id="infoText" value="Texto de ejemplo" color="#FFF" width="1.4" position="-0.75 0.1 0.01"></a-text>
    </a-entity>

    <a-entity light="type: ambient; intensity: 0.8"></a-entity>

    <script>
      AFRAME.registerComponent('hotspot-listener', {
        init: function () {
          const infoBox = document.querySelector('#infoBox');
          const infoText = document.querySelector('#infoText');
          const audio = document.querySelector('#narr');

          this.el.addEventListener('click', () => {
            const visible = infoBox.getAttribute('visible');
            infoText.setAttribute('value', 'Aquí verás una explicación breve sobre este punto oceánico.');
            infoBox.setAttribute('visible', !visible);
            if (!visible) { audio.currentTime = 0; audio.play(); } else { audio.pause(); }
          });
        }
      });

      document.addEventListener('DOMContentLoaded', () => {
        document.querySelector('#hotspot1').setAttribute('hotspot-listener', '');
      });
    </script>
  </a-scene>
</body>
</html>
